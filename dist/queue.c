/* 
  This file was generated by KaRaMeL <https://github.com/FStarLang/karamel>
 */

#include "queue.h"



Learn_LowStar_Queue_Prop_queue_st__Learn_LowStar_Queue_Test_cell
*Learn_LowStar_Queue_Test_malloc()
{
  KRML_CHECK_SIZE(sizeof (Learn_LowStar_Queue_Prop_queue_st__Learn_LowStar_Queue_Test_cell),
    (uint32_t)1U);
  Learn_LowStar_Queue_Prop_queue_st__Learn_LowStar_Queue_Test_cell
  *buf =
    KRML_HOST_MALLOC(sizeof (Learn_LowStar_Queue_Prop_queue_st__Learn_LowStar_Queue_Test_cell));
  buf[0U]
  =
    (
      (Learn_LowStar_Queue_Prop_queue_st__Learn_LowStar_Queue_Test_cell){
        .q_exit = NULL,
        .q_entry = NULL
      }
    );
  return buf;
}

void
Learn_LowStar_Queue_Test_free(
  Learn_LowStar_Queue_Prop_queue_st__Learn_LowStar_Queue_Test_cell *q
)
{
  KRML_HOST_FREE(q);
}

bool
Learn_LowStar_Queue_Test_is_empty(
  Learn_LowStar_Queue_Prop_queue_st__Learn_LowStar_Queue_Test_cell *q
)
{
  return q->q_exit == NULL;
}

void
Learn_LowStar_Queue_Test_enqueue(
  Learn_LowStar_Queue_Test_cell *x,
  Learn_LowStar_Queue_Prop_queue_st__Learn_LowStar_Queue_Test_cell *q
)
{
  x->next = NULL;
  if (q->q_entry == NULL)
    q[0U] =
      (
        (Learn_LowStar_Queue_Prop_queue_st__Learn_LowStar_Queue_Test_cell){
          .q_exit = x,
          .q_entry = x
        }
      );
  else
  {
    Learn_LowStar_Queue_Test_cell uu____1 = q->q_entry[0U];
    q->q_entry[0U] =
      (
        (Learn_LowStar_Queue_Test_cell){
          .next = x,
          .data_x = uu____1.data_x,
          .data_y = uu____1.data_y
        }
      );
    q[0U] =
      (
        (Learn_LowStar_Queue_Prop_queue_st__Learn_LowStar_Queue_Test_cell){
          .q_exit = q->q_exit,
          .q_entry = x
        }
      );
  }
}

Learn_LowStar_Queue_Test_cell
*Learn_LowStar_Queue_Test_dequeue(
  Learn_LowStar_Queue_Prop_queue_st__Learn_LowStar_Queue_Test_cell *q
)
{
  Learn_LowStar_Queue_Test_cell *rt = q->q_exit;
  q[0U] =
    (
      (Learn_LowStar_Queue_Prop_queue_st__Learn_LowStar_Queue_Test_cell){
        .q_exit = rt->next,
        .q_entry = q->q_entry
      }
    );
  if (q->q_exit == NULL)
    q[0U] =
      (
        (Learn_LowStar_Queue_Prop_queue_st__Learn_LowStar_Queue_Test_cell){
          .q_exit = q->q_exit,
          .q_entry = NULL
        }
      );
  return rt;
}

typedef Learn_LowStar_Queue_Test_cell *___Learn_LowStar_Queue_Test_cell____;

Learn_LowStar_Queue_Test_cell
*Learn_LowStar_Queue_Test_find(
  Learn_LowStar_Queue_Prop_queue_st__Learn_LowStar_Queue_Test_cell *q,
  bool (*f)(Learn_LowStar_Queue_Test_cell *x0)
)
{
  Learn_LowStar_Queue_Test_cell *it = q->q_exit;
  Learn_LowStar_Queue_Test_cell *rt = NULL;
  while (!(it == NULL))
    if (f(it))
    {
      rt = it;
      it = NULL;
    }
    else
      it = it->next;
  Learn_LowStar_Queue_Test_cell *rt0 = rt;
  return rt0;
}

Learn_LowStar_Queue_Test_cell
*Learn_LowStar_Queue_Test_mem_42(
  Learn_LowStar_Queue_Prop_queue_st__Learn_LowStar_Queue_Test_cell *q
)
{
  Learn_LowStar_Queue_Test_cell *it = q->q_exit;
  Learn_LowStar_Queue_Test_cell *rt = NULL;
  while (!(it == NULL))
    if (it->data_x == (uint32_t)42U)
    {
      rt = it;
      it = NULL;
    }
    else
      it = it->next;
  Learn_LowStar_Queue_Test_cell *rt0 = rt;
  return rt0;
}

void Learn_LowStar_Queue_Test_test_queue_spec()
{
  Learn_LowStar_Queue_Prop_queue_st__Learn_LowStar_Queue_Test_cell
  *q = Learn_LowStar_Queue_Test_malloc();
  KRML_CHECK_SIZE(sizeof (Learn_LowStar_Queue_Test_cell), (uint32_t)1U);
  Learn_LowStar_Queue_Test_cell *x0 = KRML_HOST_MALLOC(sizeof (Learn_LowStar_Queue_Test_cell));
  x0[0U]
  = ((Learn_LowStar_Queue_Test_cell){ .next = NULL, .data_x = (uint32_t)5U, .data_y = true });
  Learn_LowStar_Queue_Test_enqueue(x0, q);
  Learn_LowStar_Queue_Test_cell *f = Learn_LowStar_Queue_Test_mem_42(q);
  x0->data_x = (uint32_t)42U;
  Learn_LowStar_Queue_Test_cell *f0 = Learn_LowStar_Queue_Test_mem_42(q);
  KRML_CHECK_SIZE(sizeof (Learn_LowStar_Queue_Test_cell), (uint32_t)2U);
  Learn_LowStar_Queue_Test_cell x12[2U];
  for (uint32_t _i = 0U; _i < (uint32_t)2U; ++_i)
    x12[_i]
    = ((Learn_LowStar_Queue_Test_cell){ .next = NULL, .data_x = (uint32_t)7U, .data_y = false });
  Learn_LowStar_Queue_Test_cell *x1 = x12;
  Learn_LowStar_Queue_Test_cell *x2 = x12 + (uint32_t)1U;
  Learn_LowStar_Queue_Test_enqueue(x1, q);
  x2->data_y = true;
  Learn_LowStar_Queue_Test_cell *x0_ = Learn_LowStar_Queue_Test_dequeue(q);
  Learn_LowStar_Queue_Test_cell *x1_ = Learn_LowStar_Queue_Test_dequeue(q);
  Learn_LowStar_Queue_Test_free(q);
  KRML_HOST_FREE(x0);
}

